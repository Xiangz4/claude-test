---
name: fx-v1
description: 跨境商户换汇业务系统，提供透明汇率配置、流畅换汇交易流程和多通道对接能力
status: backlog
created: 2025-11-11T15:13:57Z
---

# PRD: fx-v1

## Executive Summary

本PRD旨在为Shoplazza平台构建换汇业务核心能力，解决跨境商户在业务增长过程中面临的资金分散管理、换汇成本不透明、流程繁琐等痛点。

通过建立灵活的对客报价体系、完整的换汇交易流程以及与PHP、港中银（BOCHK）等汇率通道的对接，将换汇业务打造为平台核心利润中心之一，形成可持续收入来源。

**目标用户**：使用Shoplazza平台的跨境商户

**核心价值**：
- 对商户：成本透明（清晰展示汇率构成）+ 流程极简（平台内一站式操作）
- 对平台：通过汇率点差开辟新收入曲线，增强用户粘性，构建资金管理生态壁垒

## Problem Statement

### 当前痛点

随着独立站业态的蓬勃发展，跨境商户在业务迅猛增长过程中面临三大核心痛点：

1. **资金分散、管理低效**
   - 多个国家、多个支付网关的收单资金形成"资金孤岛"
   - 难以统一管理和调度资金

2. **换汇黑盒、成本高企**
   - 传统换汇渠道存在"黑箱操作"
   - 汇率加点不透明，商户被动承担高昂成本

3. **流程割裂、体验不佳**
   - 商户需在多个平台间手动操作
   - 流程繁琐、到账迟缓、对账复杂

### 为什么现在解决

- 独立站商户数量快速增长，换汇需求旺盛
- 平台已具备资金账户体系（Lazza Account）基础
- 可形成差异化竞争优势，提升商户粘性

## User Stories

### 财务人员

**角色**：财务人员
**目标**：设定和维护平台标价汇率，确保报价基础准确且有利润空间

**用户故事**：
- 作为财务人员，我需要能够配置平台标价汇率的加点策略，以便在通道汇率基础上形成统一对外报价基准
- 作为财务人员，我需要监控汇率执行情况和公司汇兑收益数据统计，以便及时调整定价策略

**验收标准**：
- 可以按币种对设置差异化加点策略（固定点差或百分比加价）
- 可以手动覆盖调整特定币种对的汇率
- 系统自动生成平台标价汇率并实时更新
- 提供汇率执行监控和收益统计报表

### 运营人员（业管）

**角色**：运营人员
**目标**：为不同商户配置个性化的最终报价汇率

**用户故事**：
- 作为运营人员，我需要能够在平台标价汇率基础上，为不同商户配置个性化加点规则，以便满足差异化定价需求
- 作为运营人员，我需要处理头寸预警和特殊换汇审批，以便保障业务正常运营

**验收标准**：
- 可根据商户等级、交易规模等维度配置个性化加点
- 支持特殊商户单独议价和审批流程
- 商户配置生效后，系统自动应用最终汇率
- 头寸不足时系统发出预警并支持调拨操作

### 资金人员

**角色**：资金人员
**目标**：审核特殊汇率申请、大额交易和异常处理

**用户故事**：
- 作为资金人员，我需要审核大商户提出的特殊汇率请求，以便平衡商户价值与平台利润
- 作为资金人员，我需要对超过系统自动审批阈值的换汇交易进行人工审核，以便控制风险
- 作为资金人员，我需要处理因通道失败、系统差错导致的资金卡单，以便确保资金安全

**验收标准**：
- 工单系统支持特殊汇率审批流程
- 大额交易触发人工审核并记录审批意见
- 异常订单支持人工补汇或退回操作

### 跨境商户

**角色**：跨境商户
**目标**：快速、透明地完成换汇操作

**用户故事**：
- 作为商户，我想要看到清晰的汇率构成和预计收到的金额，以便做出明智的换汇决策
- 作为商户，我想要在30秒内锁定汇率并快速下单，以便避免汇率波动风险
- 作为商户，我想要查看换汇历史记录和订单详情，以便进行财务对账

**验收标准**：
- 系统清晰展示汇率、支付金额、到账金额
- 汇率锁定30秒，商户可在此期间确认下单
- 订单状态实时更新，支持查看详细信息
- 提供完整的换汇历史记录和导出功能

## Requirements

### Functional Requirements

#### 1. 汇率配置管理

**1.1 通道汇率采集**
- 支持从PHP、BOC-HK等通道自动采集实时汇率
- 法币汇率：每1分钟采集一次
- 数字货币汇率：每1分钟采集一次（通过Leptage通道）
- 需要采集的法币币种对：USD、AUD、CAD、SGD、GBP、EUR、JPY、HKD、CNH（共72个币种对）
- 需要采集的数字货币币种对：USD-USDT、USDT-USD、USDC-USD、USD-USDC
- 汇率数据保留历史记录用于追溯和分析

**1.2 平台标价汇率配置**
- 财务人员可在通道汇率基础上配置加点策略
- 支持两种加点方式：
  - 固定点差（Pips）：汇率小数点后四位为1pips
  - 百分比加价（%）：通道汇率×(1±X%)
- 支持按币种对设置差异化加点
- 支持手动覆盖调整特定汇率
- 配置变更需记录操作人和时间
- 一键配置功能：可批量配置多个币种对

**1.3 商户定价汇率配置**
- 运营人员可在平台标价汇率基础上配置商户个性化加点
- 支持按商户等级、交易规模等维度配置
- 支持特殊商户单独议价流程（需审批）
- 商户可选择报价通道（BOCHK或PHP）
- 配置规则：
  - Sell（商户卖价）：通道汇率+加点
  - Buy（商户买价）：通道汇率-加点
- 反向币种对配置互斥检验（如配置USD/HKD买价后，HKD/USD卖价不可再配置）

#### 2. 换汇交易核心流程

**2.1 换汇询价与报价**
- 商户输入卖出币种、买入币种和金额
- 系统实时计算商户定价汇率（基于配置规则）
- 报价有效期30秒，到期自动刷新
- 报价展示内容：
  - 汇率（保留8位小数）
  - 支付金额（卖出币种）
  - 预计到账金额（买入币种）
  - 汇率更新时间
- 支持买入金额或卖出金额双向计算

**2.2 汇率锁定与下单**
- 商户确认报价后，系统锁定汇率30秒
- 商户完成安全验证（2FA等）
- 系统校验：
  - 币种账户是否开通
  - 卖出币种余额是否充足
  - 汇率是否仍然有效（未过期）
  - 商户定价汇率是否小于通道交割汇率（防止亏损）
- 创建换汇订单并冻结商户资金（从基本户转到在途户）

**2.3 换汇执行**
- 系统向换汇通道（PHP或Leptage）发起询价
- 验证询价结果：若通道汇率高于商户定价汇率，拦截并提示"汇率已失效"
- 调用通道执行换汇：
  - 法币：从商户主账户划拨实际换汇成本金额到通道
  - 数字货币：需从平台账户划拨换汇本金到通道
- 换汇成功后，记录实际成本和预期收益

**2.4 资金出款与交割**
- 换汇成功后，系统执行资金出款到商户目标币种账户
- 更新商户账户余额：
  - 卖出币种在途户扣减全部冻结金额
  - 买入币种基本户增加到账金额
- 记录平台收益（汇率点差收益）
- 订单状态更新为"完成"
- 发送通知给商户

**2.5 异常处理**
- 换汇失败：解冻资金，订单关闭，通知商户
- 出款失败：触发工单审批流程，资金人员处理
- 通道异常：自动切换备用通道或人工介入
- 所有异常均需记录日志用于追溯

#### 3. 商户权限管理

- 运营人员配置商户可用币种对
- 未配置币种对的商户下单时提示："汇率已失效，请刷新后重试"
- 支持按商户维度设置最小/最大换汇金额限制

#### 4. 订单管理

**4.1 商户端订单查询**
- 支持按时间、币种、状态筛选订单
- 订单列表展示：订单号、交易币种对、金额、汇率、状态、时间
- 订单详情展示：完整的交易信息、汇率、金额、状态变更历史
- 支持导出订单记录（Excel格式）

**4.2 运营端订单管理**
- 支持按商户、时间、币种、状态筛选订单
- 订单详情展示：
  - 商户基础信息
  - 支付账户信息
  - 订单详情（计划金额、实际金额、汇率）
  - 通道换汇信息（通道订单号、成本）
  - 出款信息
  - 收益信息
- 支持订单导出和数据统计

### Non-Functional Requirements

#### 性能要求
- 汇率报价响应时间：95%的请求 < 500ms
- 换汇下单响应时间：95%的请求 < 2s
- 系统支持并发换汇订单：>100 TPS
- 汇率接口调用成功率：≥ 99.9%

#### 安全要求
- 换汇交易资金处理须保证强一致性，无资损风险
- 资金冻结、扣减、存入操作采用分布式事务保障
- 敏感操作需二次验证（2FA）
- 所有资金变动需记录完整审计日志
- 支持资金回滚和补偿机制

#### 兼容性要求
- 支持Chrome、Safari、Firefox等主流浏览器最新版本
- 响应式设计，支持桌面端和移动端访问
- 支持中英双语界面

#### 可用性要求
- 系统可用性：≥ 99.9%
- 计划内维护窗口需提前通知商户
- 关键接口需有降级和熔断机制

## Success Criteria

### 业务指标
- 换汇业务毛利率：从0%稳定在XX%以上
- 月换汇GMV：达到XXX万美元
- 换汇订单成功率：≥ XX%
- 商户采用率：平台活跃商户的XX%使用换汇功能

### 技术指标
- 汇率接口调用成功率：≥ 99.9%
- 换汇交易成功率：≥ 99%
- 系统可用性：≥ 99.9%
- P95响应时间：< 500ms（报价）、< 2s（下单）

### 用户体验指标
- 商户满意度评分：≥ 4.5/5
- 换汇流程完成率：≥ 95%
- 平均换汇时长：< 3分钟

## Constraints & Assumptions

### 技术约束
- 需依赖现有Lazza Account资金账户系统
- 需对接PHP和BOC-HK汇率通道API
- 需对接Leptage数字货币换汇通道
- 当前通道情况：客户VA通道、公司资金调拨通道、换汇通道、出款通道为同一家（PHP）

### 业务约束
- 汇率采集需要前置实现，以便进行汇兑收益对比
- 上线前需确认平台标价汇率加点和商户定价汇率加点
- 支持的币种：USD、AUD、CAD、SGD、GBP、EUR、JPY、HKD、CNH、USDT、USDC
- 汇率有效期固定为30秒

### 合规约束
- 需符合各地区外汇交易合规要求
- 需满足反洗钱（AML）和了解你的客户（KYC）要求
- 大额交易需人工审核

### 假设条件
- 假设商户已完成KYC认证
- 假设商户在Lazza Account中有足够余额
- 假设通道服务稳定可用
- 假设汇率波动在合理范围内

## Out of Scope

本期**不包含**以下功能（未来版本考虑）：

1. **资金监控与头寸管理**
   - 全局概览各币种头寸
   - 头寸不足预警与调拨功能

2. **多换汇通道智能路由**
   - 根据成本、成功率自动选择最优通道
   - 通道故障自动切换

3. **外汇自营交易**
   - 平台主动进行外汇交易套利

4. **高级定价策略**
   - 基于市场波动的动态定价
   - 批量换汇优惠
   - VIP商户专属汇率

5. **风控系统**
   - 异常交易检测
   - 商户风险评级
   - 自动风控规则引擎

6. **高级报表与分析**
   - BI数据看板
   - 收益预测模型
   - 商户画像分析

## Dependencies

### 外部依赖

1. **PHP通道**
   - 实时汇率API
   - 换汇询价API
   - 换汇下单API
   - 换汇历史查询API
   - 资金转账API

2. **BOC-HK（港中银）**
   - 实时汇率数据源
   - API文档：https://mds1a.trkdhs.com/bochkfxibs/mktinfo

3. **Leptage通道**
   - 数字货币询价API
   - 数字货币换汇API
   - 资金转账API

### 内部依赖

1. **Lazza Account系统**
   - 商户账户查询
   - 账户余额查询
   - 资金冻结/解冻
   - 资金划拨（基本户 ↔ 在途户）
   - 资金记账

2. **计费中心**
   - 汇率计算引擎
   - 手续费计算
   - 收益计算

3. **运营管理系统**
   - 商户管理
   - 权限管理
   - 工单审批系统

4. **认证系统**
   - 商户登录认证
   - 二次验证（2FA）

### 团队依赖

- **后端团队**：负责核心业务逻辑和通道对接
- **前端团队**：负责商户端和运营端界面开发
- **UED团队**：负责交互设计和视觉设计
- **测试团队**：负责功能测试、性能测试、安全测试
- **运维团队**：负责系统部署、监控和运维支持

## Appendix

### 术语表

| 术语 | 解释 |
|------|------|
| BOCHK | 中银香港（Bank of China (Hong Kong) Limited） |
| 通道汇率 | 从VA账户通道服务商（如PHP）或其他公信方机构（如港中银、路透）获取到的底层汇率值 |
| 平台标价汇率 | 在通道汇率基础上，通过"加法"（可配负值即为减法）计算后得出的对客标准报价汇率 |
| 商户定价汇率 | 在平台标价汇率基础上，通过"加法"（可配负值即为减法）计算的，与每个商户关联的最终对客报价。不配置则默认为平台标价汇率 |
| Pips | 汇率小数点后四位为1pips，用于表示汇率点差 |
| VA账户 | Virtual Account，虚拟账户，用于资金隔离和管理 |

### 相关文档

- 换汇业务基础知识分享：[链接]
- Lazza Account系统文档：[链接]
- PHP通道API文档：[链接]
- BOC-HK汇率API文档：https://mds1a.trkdhs.com/bochkfxibs/mktinfo
- Leptage API文档：[链接]

### 联系人

- 产品负责人：lu
- 技术负责人：[待补充]
- 业务负责人：[待补充]

---

**文档版本**：V1.0
**最后更新**：2025-11-11
**创建人**：lu
**状态**：First version finished
